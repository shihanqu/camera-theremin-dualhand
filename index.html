<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Camera Theremin</title>
    <link rel="icon" type="image/svg+xml" href="./assets/theremin-favicon.svg" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="app">
      <header>
        <h1>Camera Theremin</h1>
        <p>
          Matches standard theremin technique: dominant hand controls the vertical pitch antenna, non-dominant hand
          controls the horizontal volume antenna.
        </p>
      </header>

      <section class="controls">
        <button id="startButton" type="button">Start Theremin</button>
        <fieldset class="play-mode">
          <legend>Playing Mode</legend>
          <label><input type="radio" name="playMode" id="modeRight" value="right" checked /> Right-handed</label>
          <label><input type="radio" name="playMode" id="modeLeft" value="left" /> Left-handed</label>
        </fieldset>
        <div class="tuning">
          <label for="pitchField">Pitch Field</label>
          <input id="pitchField" type="range" min="28" max="62" value="40" step="1" />
          <span id="pitchFieldValue">0.40</span>
        </div>
        <p id="status" role="status" aria-live="polite">Click start to enable camera and audio.</p>
      </section>

      <section class="stage">
        <div class="video-wrap">
          <video id="inputVideo" playsinline></video>
          <canvas id="overlayCanvas"></canvas>
        </div>
        <div class="legend" aria-live="polite">
          <span><i class="swatch pitch-hand"></i><span id="pitchHandLegend">Right hand</span> (pitch hand)</span>
          <span><i class="swatch volume-hand"></i><span id="volumeHandLegend">Left hand</span> (volume hand)</span>
          <span><i class="swatch pitch-antenna"></i>Pitch antenna (vertical)</span>
          <span><i class="swatch volume-antenna"></i>Volume antenna (horizontal loop)</span>
        </div>
        <div class="readout" aria-live="polite">
          <div>
            <span class="label">Pitch</span>
            <span id="pitchValue">-- Hz</span>
          </div>
          <div>
            <span class="label">Volume</span>
            <span id="volumeValue">-- %</span>
          </div>
          <div>
            <span class="label"><span id="pitchHandLabel">Right Hand</span> (Pitch Hand)</span>
            <span id="pitchHandState">Missing</span>
          </div>
          <div>
            <span class="label"><span id="volumeHandLabel">Left Hand</span> (Volume Hand)</span>
            <span id="volumeHandState">Missing</span>
          </div>
        </div>
        <p class="technique">
          Technique: move your pitch hand closer to the vertical antenna for higher notes. Keep your volume hand
          above the loop for sustained notes, and move it down toward the loop to mute/cut notes.
        </p>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script type="module" src="./app.js"></script>
  </body>
</html>
